{% load static i18n %}
<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}{{ settings.RESTAURANT_NAME }}{% endblock %}</title>

    <!-- Tailwind CDN (kept exactly) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind config (kept exactly) -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              beige: "#f5f0e6",
              dark: "#3e2723",
              lightbrown: "#8d6e63",
              gold: "#bfa76f",
            },
          },
        },
      };
    </script>

    <!-- Base CSS -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">

    <!-- Flatpickr (kept exactly) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_brown.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="{% url 'javascript-catalog' %}"></script>
    
    {% block extra_head %}{% endblock %}
    {% block extra_head_scripts %}{% endblock %}
  </head>

  <body class="bg-beige text-dark">
    <!-- NAV -->
    <header class="bg-[#3b231d] text-beige border-b border-white/10">
      <div class="max-w-6xl mx-auto px-6 py-3 flex items-center justify-between">
        <a href="{% url 'restaurant:home' %}" class="flex items-center gap-3">
          <img
            src="{% static 'images/logo/logo.jpg' %}"
            alt="{{ settings.RESTAURANT_NAME }} Logo"
            class="h-10 md:h-12 w-auto object-contain rounded-sm"
          />
          <span class="sr-only">{{ settings.RESTAURANT_NAME }}</span>
        </a>

        <!-- DESKTOP NAV (UNCHANGED) -->
        <nav class="hidden md:flex items-center gap-7 text-sm">
          <a href="{% url 'restaurant:home' %}"
            class="hover:text-gold {% if request.path == '/' or request.path == '/en/' or request.path == '/fi/' %}text-gold font-semibold{% endif %}">
            {% trans "Home" %}
          </a>

          <a href="{% url 'restaurant:menu' %}"
            class="hover:text-gold {% if '/menu' in request.path %}text-gold font-semibold{% endif %}">
            {% trans "Menu" %}
          </a>

          <a href="{% url 'restaurant:about' %}"
            class="hover:text-gold {% if '/about' in request.path %}text-gold font-semibold{% endif %}">
            {% trans "About" %}
          </a>
          {# ✅ Customer account buttons (desktop) #}
{# ✅ Profile dropdown (desktop) #}
<div class="relative" id="profileMenuWrap">
  <button type="button"
          id="profileMenuBtn"
          class="inline-flex items-center justify-center w-10 h-10 rounded-full border border-white/20 bg-white/5 hover:border-gold/60 hover:text-gold transition"
          aria-haspopup="true"
          aria-expanded="false"
          aria-controls="profileMenu">
    {# user icon (no extra file needed) #}
    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
      <path stroke-linecap="round" stroke-linejoin="round" d="M20 21a8 8 0 10-16 0" />
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 11a4 4 0 100-8 4 4 0 000 8z" />
    </svg>
  </button>

  <div id="profileMenu"
       class="hidden absolute right-0 mt-3 w-60 rounded-2xl border border-[#3e2723]/10 bg-white shadow-xl overflow-hidden z-50">
    <div class="px-4 py-3 bg-[#f5f0e6]">
      {% if request.user.is_authenticated %}
        <div class="text-xs uppercase tracking-wider text-[#3e2723]/50">{% trans "Signed in as" %}</div>
        <div class="text-sm font-semibold text-[#3e2723] truncate">{{ request.user.email|default:request.user.username }}</div>
      {% else %}
        <div class="text-sm font-semibold text-[#3e2723]">{% trans "Welcome" %}</div>
        <div class="text-xs text-[#3e2723]/60">{% trans "Login to manage orders & reservations." %}</div>
      {% endif %}
    </div>

    <div class="py-2">
      {% if request.user.is_authenticated %}
        <a href="{% url 'accounts:dashboard' %}"
           class="block px-4 py-2 text-sm text-[#3e2723] hover:bg-[#f5f0e6]">
          {% trans "My Account" %}
        </a>
        <a href="{% url 'accounts:my_orders' %}"
           class="block px-4 py-2 text-sm text-[#3e2723] hover:bg-[#f5f0e6]">
          {% trans "My Orders" %}
        </a>
        <a href="{% url 'accounts:my_reservations' %}"
           class="block px-4 py-2 text-sm text-[#3e2723] hover:bg-[#f5f0e6]">
          {% trans "My Reservations" %}
        </a>

        <div class="my-2 h-px bg-[#3e2723]/10"></div>

        <a href="{% url 'accounts:logout' %}"
           class="block px-4 py-2 text-sm text-[#3e2723] hover:bg-[#f5f0e6]">
          {% trans "Logout" %}
        </a>
      {% else %}
        <a href="{% url 'accounts:login' %}"
           class="block px-4 py-2 text-sm text-[#3e2723] hover:bg-[#f5f0e6]">
          {% trans "Login" %}
        </a>
        <a href="{% url 'accounts:signup' %}"
           class="block px-4 py-2 text-sm font-semibold text-[#3e2723] hover:bg-[#f5f0e6]">
          {% trans "Create Account" %}
        </a>

        <div class="my-2 h-px bg-[#3e2723]/10"></div>

        <a href="{% url 'accounts:password_reset' %}"
           class="block px-4 py-2 text-sm text-[#3e2723] hover:bg-[#f5f0e6]">
          {% trans "Forgot password?" %}
        </a>
      {% endif %}
    </div>
  </div>
</div>


          {# ✅ keep language toggle exactly as you have it #}
          {% get_current_language as CURRENT_LANGUAGE %}
          {% with CURRENT_LANGUAGE|slice:':2' as LANG %}
            <div class="ml-4 flex items-center gap-3">
              <span class="{% if LANG == 'en' %}text-gold{% else %}text-beige/60{% endif %} text-xs font-semibold">EN</span>

              <a href="/{% if LANG == 'en' %}fi{% else %}en{% endif %}{{ request.path|slice:'3:' }}"
                class="relative w-16 h-8 rounded-full overflow-hidden shadow-inner transition block">
                {% if LANG == 'en' %}
                  <img src="https://flagcdn.com/w80/gb.png" class="absolute inset-0 w-full h-full object-cover" />
                {% else %}
                  <img src="https://flagcdn.com/w80/fi.png" class="absolute inset-0 w-full h-full object-cover" />
                {% endif %}

                <span class="absolute top-1 w-6 h-6 bg-white rounded-full shadow-md transition-all duration-300
                  {% if LANG == 'en' %}left-1{% else %}right-1{% endif %}">
                </span>
              </a>

              <span class="{% if LANG == 'fi' %}text-gold{% else %}text-beige/60{% endif %} text-xs font-semibold">FI</span>
            </div>
          {% endwith %}
        </nav>

        <!-- MOBILE MENU BUTTON (UNCHANGED) -->
        <button type="button"
                id="mobileMenuBtn"
                class="md:hidden inline-flex items-center justify-center p-2 rounded-sm border border-white/20 text-beige hover:text-gold hover:border-gold/60"
                aria-controls="mobileMenu"
                aria-expanded="false">
          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>

      <!-- MOBILE NAV (UNCHANGED) -->
      <div id="mobileMenu" class="md:hidden hidden border-t border-white/10">
        <div class="max-w-6xl mx-auto px-6 py-4 space-y-2 text-sm">
          <a href="{% url 'restaurant:home' %}"
            class="block px-3 py-2 rounded-sm hover:bg-white/5 hover:text-gold
                    {% if request.path == '/' or request.path == '/en/' or request.path == '/fi/' %}text-gold font-semibold{% endif %}">
            {% trans "Home" %}
          </a>

          <a href="{% url 'restaurant:menu' %}"
            class="block px-3 py-2 rounded-sm hover:bg-white/5 hover:text-gold
                    {% if '/menu' in request.path %}text-gold font-semibold{% endif %}">
            {% trans "Menu" %}
          </a>

          <a href="{% url 'restaurant:about' %}"
            class="block px-3 py-2 rounded-sm hover:bg-white/5 hover:text-gold
                    {% if '/about' in request.path %}text-gold font-semibold{% endif %}">
            {% trans "About" %}
          </a>
          {# ✅ Customer account buttons (mobile) #}
{# ✅ Profile section (mobile) #}
<div class="mt-2 rounded-xl border border-white/10 overflow-hidden">
  <button type="button"
          id="profileMenuBtnMobile"
          class="w-full flex items-center justify-between px-3 py-2 hover:bg-white/5">
    <div class="flex items-center gap-2">
      <span class="inline-flex items-center justify-center w-9 h-9 rounded-full border border-white/20 bg-white/5">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
          <path stroke-linecap="round" stroke-linejoin="round" d="M20 21a8 8 0 10-16 0" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 11a4 4 0 100-8 4 4 0 000 8z" />
        </svg>
      </span>

      <div class="text-left">
        {% if request.user.is_authenticated %}
          <div class="text-xs text-beige/60">{% trans "My Account" %}</div>
          <div class="text-sm font-semibold truncate max-w-[220px]">{{ request.user.email|default:request.user.username }}</div>
        {% else %}
          <div class="text-sm font-semibold">{% trans "Account" %}</div>
          <div class="text-xs text-beige/60">{% trans "Login or create account" %}</div>
        {% endif %}
      </div>
    </div>

    <svg class="w-4 h-4 text-beige/70" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M6 9l6 6 6-6"/>
    </svg>
  </button>

  <div id="profileMenuMobile" class="hidden border-t border-white/10">
    {% if request.user.is_authenticated %}
      <a href="{% url 'accounts:dashboard' %}" class="block px-3 py-2 hover:bg-white/5 hover:text-gold">{% trans "Dashboard" %}</a>
      <a href="{% url 'accounts:my_orders' %}" class="block px-3 py-2 hover:bg-white/5 hover:text-gold">{% trans "My Orders" %}</a>
      <a href="{% url 'accounts:my_reservations' %}" class="block px-3 py-2 hover:bg-white/5 hover:text-gold">{% trans "My Reservations" %}</a>
      <a href="{% url 'accounts:logout' %}" class="block px-3 py-2 hover:bg-white/5 hover:text-gold">{% trans "Logout" %}</a>
    {% else %}
      <a href="{% url 'accounts:login' %}" class="block px-3 py-2 hover:bg-white/5 hover:text-gold">{% trans "Login" %}</a>
      <a href="{% url 'accounts:signup' %}" class="block px-3 py-2 hover:bg-white/5 hover:text-gold font-semibold">{% trans "Create Account" %}</a>
      <a href="{% url 'accounts:password_reset' %}" class="block px-3 py-2 hover:bg-white/5 hover:text-gold">{% trans "Forgot password?" %}</a>
    {% endif %}
  </div>
</div>


          {# language toggle same as you already have #}
          {% get_current_language as CURRENT_LANGUAGE %}
          {% with CURRENT_LANGUAGE|slice:':2' as LANG %}
            <div class="flex items-center justify-center gap-4 pt-3">
              <span class="{% if LANG == 'en' %}text-gold{% else %}text-beige/60{% endif %} text-sm font-semibold">EN</span>

              <a href="/{% if LANG == 'en' %}fi{% else %}en{% endif %}{{ request.path|slice:'3:' }}"
                class="relative w-14 h-7 rounded-full overflow-hidden shadow-inner block">
                {% if LANG == 'en' %}
                  <img src="https://flagcdn.com/w80/gb.png" class="absolute inset-0 w-full h-full object-cover" />
                {% else %}
                  <img src="https://flagcdn.com/w80/fi.png" class="absolute inset-0 w-full h-full object-cover" />
                {% endif %}
                <span class="absolute top-1 w-5 h-5 bg-white rounded-full shadow-md {% if LANG == 'en' %}left-1{% else %}right-1{% endif %}"></span>
              </a>

              <span class="{% if LANG == 'fi' %}text-gold{% else %}text-beige/60{% endif %} text-sm font-semibold">FI</span>
            </div>
          {% endwith %}
        </div>
      </div>
    </header>

    {% if messages %}
      <div class="max-w-6xl mx-auto px-6 mt-4">
        {% for message in messages %}
          <div class="mb-2 p-3 rounded bg-gold text-dark">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <main>
      {% block content %}{% endblock %}
    </main>

    <!-- SIMPLE PREMIUM FOOTER (UNCHANGED) -->
    <footer class="footer-bg text-beige mt-12">
      <div class="max-w-6xl mx-auto px-6 py-10">
        <div class="footer-card rounded-lg p-7 md:p-9">
          <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-8">

            <!-- Left -->
            <div class="min-w-[240px]">
              <div class="brand-script text-3xl text-white mb-1">{{ settings.RESTAURANT_NAME }}</div>
              <div class="text-sm text-beige/85 leading-relaxed whitespace-pre-line">
                {{ settings.RESTAURANT_ADDRESS }}
              </div>

              <!-- ⭐ Dynamic Rating Section -->
              <div class="mt-5">
                <a href="{% url 'restaurant:reviews' %}"
                  class="inline-flex items-center gap-3 text-gold text-lg font-semibold hover:opacity-90 transition">

                  <span>{{ footer_average_rating }}</span>
                  <span class="text-sm text-beige/70">/ 5</span>

                  <div class="relative w-max ml-2">
                    <div class="flex text-sm text-beige/30">
                      ★★★★★
                    </div>
                    <div class="absolute top-0 left-0 overflow-hidden text-sm"
                        style="width: {{ footer_star_percentage }}%;">
                      <div class="text-gold">
                        ★★★★★
                      </div>
                    </div>
                  </div>

                  <span class="text-sm text-beige/70">
                    ({{ footer_total_reviews }})
                  </span>

                </a>

                <div class="mt-3">
                  <a href="{% url 'restaurant:reviews' %}#leave-review"
                    class="inline-block text-xs px-4 py-2 rounded-sm bg-gold text-dark font-semibold hover:opacity-90 transition">
                    Give a Review
                  </a>
                </div>
              </div>

              <!-- Social Media -->
              <div class="mt-5 flex gap-4">
                <a href="https://www.instagram.com/ravintola_sinet"
                  target="_blank"
                  class="text-beige hover:text-gold transition">
                  <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M7 2C4.2 2 2 4.2 2 7v10c0 2.8 2.2 5 5 5h10c2.8 0 5-2.2 5-5V7c0-2.8-2.2-5-5-5H7zm5 5a5 5 0 110 10 5 5 0 010-10zm6.5-.9a1.4 1.4 0 110 2.8 1.4 1.4 0 010-2.8z"/>
                  </svg>
                </a>

                <a href="https://www.facebook.com/ravintolasinetisomyy"
                  target="_blank"
                  class="text-beige hover:text-gold transition">
                  <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M22 12a10 10 0 10-11.5 9.9v-7H7v-3h3.5V9.5c0-3.4 2-5.3 5-5.3 1.4 0 2.8.2 2.8.2v3h-1.6c-1.6 0-2 1-2 2v2.5H18l-.5 3h-2.8v7A10 10 0 0022 12z"/>
                  </svg>
                </a>

                <a href="https://wa.me/358504557367"
                  target="_blank"
                  aria-label="WhatsApp"
                  class="text-beige hover:text-gold transition">

                  <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20.5 3.5A11.8 11.8 0 0012 .5C5.8.5.8 5.5.8 11.7c0 2 .5 3.9 1.4 5.6L.5 23.5l6.4-1.7a11.9 11.9 0 005.1 1.2h.1c6.2 0 11.2-5 11.2-11.2 0-3-1.2-5.8-3.3-7.9zM12 21.3c-1.7 0-3.4-.5-4.8-1.4l-.3-.2-3.8 1 1-3.7-.2-.3a9.2 9.2 0 01-1.4-4.9c0-5.1 4.1-9.2 9.2-9.2 2.5 0 4.8 1 6.5 2.7a9.2 9.2 0 012.7 6.5c0 5.1-4.1 9.2-9.2 9.2zm5-6.8c-.3-.2-1.7-.8-2-.9-.3-.1-.5-.2-.7.2s-.8.9-1 1.1c-.2.2-.4.2-.7.1-.3-.2-1.2-.4-2.3-1.4-.9-.8-1.5-1.7-1.7-2-.2-.3 0-.5.1-.7.1-.1.3-.4.4-.6.1-.2.1-.4.2-.6 0-.2 0-.4-.1-.6-.1-.2-.7-1.7-1-2.3-.2-.6-.5-.5-.7-.5h-.6c-.2 0-.5.1-.8.4s-1 1-1 2.4 1 2.8 1.2 3c.1.2 2 3 4.9 4.2.7.3 1.2.5 1.7.6.7.2 1.4.2 1.9.1.6-.1 1.7-.7 2-1.3.2-.6.2-1.2.2-1.3 0-.1-.2-.2-.5-.4z"/>
                  </svg>
                </a>
              </div>
            </div>

            <!-- Middle -->
            <div class="flex-1">
              <div class="brand-serif text-lg font-semibold mb-2">{% trans "Opening Times" %}</div>
              <div class="text-sm text-beige/85 hidden md:grid grid-cols-2 gap-x-10 gap-y-1 max-w-md">
                <div class="flex justify-between gap-6"><span>{% trans "Mon" %}</span><span class="text-beige/70">10:00–22:00</span></div>
                <div class="flex justify-between gap-6"><span>{% trans "Tue" %}</span><span class="text-beige/70">10:00–22:00</span></div>
                <div class="flex justify-between gap-6"><span>{% trans "Wed" %}</span><span class="text-beige/70">10:00–22:00</span></div>
                <div class="flex justify-between gap-6"><span>{% trans "Thu" %}</span><span class="text-beige/70">10:00–22:00</span></div>
                <div class="flex justify-between gap-6"><span>{% trans "Fri" %}</span><span class="text-beige/70">10:00–22:00</span></div>
                <div class="flex justify-between gap-6"><span>{% trans "Sat" %}</span><span class="text-beige/70">10:00–22:00</span></div>
                <div class="flex justify-between gap-6"><span>{% trans "Sun" %}</span><span class="text-beige/70">10:00–22:00</span></div>
              </div>
              

              <div class="text-sm text-beige/85 md:hidden space-y-1 max-w-md">
                <div class="flex items-center justify-between py-1 border-b border-white/10">
                  <span>{% trans "Mon" %}</span><span class="text-beige/70">10:00–22:00</span>
                </div>
                <div class="flex items-center justify-between py-1 border-b border-white/10">
                  <span>{% trans "Tue" %}</span><span class="text-beige/70">10:00–22:00</span>
                </div>
                <div class="flex items-center justify-between py-1 border-b border-white/10">
                  <span>{% trans "Wed" %}</span><span class="text-beige/70">10:00–22:00</span>
                </div>
                <div class="flex items-center justify-between py-1 border-b border-white/10">
                  <span>{% trans "Thu" %}</span><span class="text-beige/70">10:00–22:00</span>
                </div>
                <div class="flex items-center justify-between py-1 border-b border-white/10">
                  <span>{% trans "Fri" %}</span><span class="text-beige/70">10:00–22:00</span>
                </div>
                <div class="flex items-center justify-between py-1 border-b border-white/10">
                  <span>{% trans "Sat" %}</span><span class="text-beige/70">10:00–22:00</span>
                </div>
                <div class="flex items-center justify-between py-1">
                  <span>{% trans "Sun" %}</span><span class="text-beige/70">10:00–22:00</span>
                </div>
              </div>
            </div>

            <!-- Right -->
            <div class="min-w-[220px]">
              <div class="brand-serif text-lg font-semibold mb-2">{% trans "Contact" %}</div>

              <div class="text-sm text-beige/85 space-y-2">
                <div class="flex items-center gap-2">
                  <svg class="w-4 h-4 text-gold" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                    <path d="M22 16.9v3a2 2 0 0 1-2.2 2 19.8 19.8 0 0 1-8.6-3.1 19.4 19.4 0 0 1-6-6A19.8 19.8 0 0 1 2.1 4.2 2 2 0 0 1 4.1 2h3a2 2 0 0 1 2 1.7c.1.9.3 1.8.6 2.6a2 2 0 0 1-.5 2.1L8 9.6a16 16 0 0 0 6 6l1.2-1.2a2 2 0 0 1 2.1-.5c.8.3 1.7.5 2.6.6A2 2 0 0 1 22 16.9Z"></path>
                  </svg>
                  <a href="tel:+358504557367" class="underline underline-offset-4 hover:text-gold">
                    +358504557367
                  </a>
                </div>

                <div class="pt-2 flex flex-col gap-3">
                  <a href="https://wolt.com/en/fin/joensuu/restaurant/ravintola-sinet"
                    target="_blank"
                    class="footer-link text-sm font-semibold justify-center">
                    <svg class="w-4 h-4 text-gold" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                      <path d="M12 3a9 9 0 1 0 9 9"></path>
                      <path d="M12 3v9l6 3"></path>
                    </svg>
                    {% trans "Order on Wolt" %}
                  </a>

                  <a href="{% url 'restaurant:reservation' %}"
                     class="btn-wood px-5 py-2 rounded-sm font-semibold text-white text-center">
                    {% trans "Make Reservation" %}
                  </a>

                  <a href="{% url 'restaurant:menu' %}"
                    class="btn-gold px-5 py-2 rounded-sm font-semibold text-dark text-center">
                    {% trans "Order Online" %}
                  </a>
                </div>

              </div>
            </div>

          </div>

          <div class="mt-8 hairline"></div>

          <div class="mt-4 text-center text-xs text-beige/60">
            &copy; {% now 'Y' %} {{ settings.RESTAURANT_NAME }}. {% trans "All rights reserved." %}
          </div>
        </div>
      </div>

      {% block extra_body %}{% endblock %}
    </footer>

    <script src="{% static 'js/profile-menu.js' %}" defer></script>

    <!-- ✅ Mobile menu JS moved into static file (same behavior) -->
    <script src="{% static 'js/mobile-menu.js' %}" defer></script>

  </body>
</html>
